!function(e,t){"use strict";function n(n){function s(){for(var e,t=/\{([\s\S]+?)\}/g,n="";null!==(e=t.exec(w.path));)n+="|\\{"+e[1]+"\\}";return new RegExp(n.substr(1),"g")}function u(e){for(var t=d(e),n=e.length,i=0;n>i;i++)R.push(r(e[i],t[i],w.lazyload,w.centerImage)),N.push(e[i]),T.push(t[i])}function l(e){var t,n=e.src.split("?"),r=n[1];return e.path=n[0],t=w.path.replace(E,function(t,n,r){return c(e,t,n,r)}),r&&(t+=m?"&"+r:"?"+r),e.path=t,t}function c(e,t){var n;switch(t){case"{width}":return n=g(w.widths,e.offsetWidth)*(w.dubbleSizeRetina&&o?2:1),e.width=n,n;case"{height}":return n=g(w.heights,e.offsetHeight)*(w.dubbleSizeRetina&&o?2:1),e.height=n,n;case"{retina}":return o?1:0;default:return n=t.substr(1,t.length-2),n in e?e[n]:""}}function d(e){for(var t,n,r=[],i=e.length,a=0,o={};i>a;a++){r[a]={},r[a].offsetWidth=e[a].offsetWidth,r[a].offsetHeight=e[a].offsetHeight,t=e[a].getElementsByTagName("noscript")[0],o=t.dataset?t.dataset:f(t);for(n in o)r[a][n]=o[n];r[a].path=l(r[a])}return r}function f(e){var t,n,r,i={},a=0;if("undefined"==typeof e||!("attributes"in e))return i;for(t=e.attributes,n=t.length;n>a;a++)/^data-/.test(t[a].name)&&(r=t[a].name.substr(5).replace(/-(.)/g),i[r]=t[a].value);return i}function h(e){var n=[];return e=e.replace(/[.]/,""),n=t.querySelectorAll?t.querySelectorAll("."+e):p(e)}function p(e){var n,r=[],i=t.getElementsByTagName("*");for(n in i)(" "+i[n].className+" ").indexOf(" "+e+" ")>-1&&r.push(i[n]);return r}function g(e,t){var n,r,i,a,o=0;if(!e)return t;for(n=e.length,a=e[n-1];n>o;o++){if(i=e[o]-t,w.closestAbove){if(0>i)continue}else i=0>i?~i:i;(void 0===r||r>i)&&(r=i,a=e[o])}return a}function v(){var t=0,n=R.length;for(w.reloadOnResize&&e.removeEventListener("resize",b);n>t;t++)R[t].destruct();R=null,N=null,T=null}var m,E,y,b,L,w={},z={nodeList:[],className:"rimd",widths:["320","600","1024"],heights:["320","600","1024"],path:"resimage/?image={path}&w={width}",reloadOnResize:!1,lazyload:!1,closestAbove:!1,centerImage:!1,dubbleSizeRetina:!1},R=[],N=[],T=[];return w=i(z,n),m=w.path.split("?").length>1,E=s(),y=w.nodeList.length?w.nodeList:h(w.className),u(y),y=null,w.reloadOnResize&&(b=a(function(){for(var e=d(N),t=0,n=N.length;n>t;t++)T[t].path!==l(e[t])&&R[t].updateImage(e[t]);T=e}),e.addEventListener("resize",b)),L={destruct:v,options:w,update:b,addImages:u}}function r(n,r,i,o){function s(r){r.path&&(d&&d.parentNode&&d.parentNode.removeChild(d),d=t.createElement("img"),d.src=r.path,r.alt&&(d.alt=r.alt),r.title&&(d.title=r.title),o&&(r.width&&(d.style.left="50%",d.style.marginLeft=-r.width/2+"px"),r.height&&(d.style.top="50%",d.style.marginTop=-r.height/2+"px")),!i||u(n)?n.appendChild(d):(l(),e.addEventListener("scroll",f),e.addEventListener("resize",h)))}function u(n){var r=n.dataset&&n.dataset.top?n.dataset.top:n.getBoundingClientRect().top,i=t.documentElement,a=r<=(e.pageYOffset||i.scrollTop)-(i.clientTop||0)+(e.innerHeight||i.clientHeight);return a||!n.dataset||n.dataset.top||(n.dataset.top=r),a}function l(){e.removeEventListener("scroll",f),e.removeEventListener("resize",h)}function c(){l(),d&&d.parentNode&&d.parentNode.removeChild(d),d=null}var d,f=a(function(){u(n)&&(n.appendChild(d),l())}),h=a(function(){"undefined"!=typeof n.dataset&&(n.dataset.top=n.getBoundingClientRect().top),f()});return s(r),{removeListeners:l,updateImage:s,destruct:c}}function i(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a(e,t,n){var r,i;return t=t||17,function(){var a=new Date,o=arguments;n=n||this,r&&r+t>a?(clearTimeout(i),i=setTimeout(function(){r=a,e.apply(n,o)},t)):(r=a,e.apply(n,o))}}var o=e.devicePixelRatio>1;e.addEventListener||!function(e,t,n,r,i,a,o){e[r]=t[r]=n[r]=function(e,t){var n=this;o.unshift([n,e,t,function(e){e.currentTarget=n,e.preventDefault=function(){e.returnValue=!1},e.stopPropagation=function(){e.cancelBubble=!0},e.target=e.srcElement||n,t.call(n,e)}]),this.attachEvent("on"+e,o[0][3])},e[i]=t[i]=n[i]=function(e,t){var n,r=0;for(r;n==o[r];++r)if(n[0]==this&&n[1]==e&&n[2]==t)return this.detachEvent("on"+e,o.splice(r,1)[0][3])},e[a]=t[a]=n[a]=function(e){return this.fireEvent("on"+e.type,e)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]),e.Rimd=n}(this,this.document);